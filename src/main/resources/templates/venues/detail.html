<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title th:text="${venue.name} + ' - Complejo'">Venue</title>
    <link rel="stylesheet" th:href="@{/css/venues.css}" />
</head>
<body>
<header>
    <a href="/venues">← Volver</a>
    <h1 th:text="${venue.name}">Nombre Venue</h1>
    <p th:text="${venue.address}">Dirección</p>
</header>

<section class="venue-meta">
    <img th:src="${venue.mainPhotoUrl != null ? venue.mainPhotoUrl : '/images/placeholder.png'}" class="venue-photo" />
    <div>
        <p>Pago en sitio: <span th:text="${venue.allowOnsitePayment}">false</span></p>
        <p>Transferencia: <span th:text="${venue.allowBankTransfer}">false</span></p>
        <p>Pago online: <span th:text="${venue.allowOnlinePayment}">false</span></p>
    </div>
</section>

<section class="fields-grid">
    <h2>Canchas</h2>
    <div th:each="f : ${fields}" class="field-card">
        <img th:src="${f.firstPhoto != null ? f.firstPhoto : '/images/field-placeholder.png'}" alt="foto cancha"/>
        <div class="field-body">
            <h3 th:text="${f.name}">Cancha</h3>
            <p th:text="${f.capacityPlayers} + ' jugadores • ' + f.slotMinutes + ' min'">info</p>
            <p>Precio: <span th:text="${f.pricePerHour != null ? f.pricePerHour : '—'}">0</span></p>
            <button
                    class="btn-availability"
                    th:data-field-id="${f.id}"
                    th:data-min="${f.minBookingHours}"
                    th:data-open="${f.openHour}"
                    th:data-close="${f.closeHour}"
                    th:data-price="${f.pricePerHour}"
            >Ver disponibilidad</button>
        </div>
    </div>
</section>

<!-- Modal (hidden by default) -->
<div id="availabilityModal" class="modal" aria-hidden="true" style="display:none;">
    <div class="modal-content">
        <button id="modalClose" class="modal-close">X</button>
        <h3 id="modalFieldName">Disponibilidad</h3>

        <div class="date-row">
            <label>Selecciona fecha:
                <input type="date" id="availabilityDate" />
            </label>
            <button id="loadSlots">Cargar</button>
        </div>

        <div id="slotsContainer" class="slots-grid"></div>

        <div id="selectionSummary" style="display:none;">
            <p>Seleccion: <span id="selLabel"></span></p>
            <p>Precio total: <span id="selPrice"></span></p>

            <label>Método de pago:
                <select id="paymentMethod">
                    <option value="ONSITE">Pagar en sitio</option>
                    <option value="BANK">Transferencia</option>
                </select>
            </label>

            <button id="confirmReservation" class="btn-confirm">Reservar</button>
        </div>
    </div>
</div>

<script th:src="@{/js/availability.js}" defer></script>
</body>
</html>
